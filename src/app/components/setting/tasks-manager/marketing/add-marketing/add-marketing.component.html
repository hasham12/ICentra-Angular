<div class="container-fluid">
    <div class="welcome-message">
        <div class="welcome-header d-flex">
            <h3>Task Settings</h3>
            <app-breadcrumb></app-breadcrumb>
        </div>
    </div><!-- /.welcome-message -->
</div>

<div class="inner-wrapper" id="wrapper">
    <div id="content-wrapper">
        <div class="container-fluid">
            <div class="welcome-outer-content">
                <p>This section refers to all details retgarding the user settings</p>
                <div class="activity-opner">
                    <i class="fa fa-bullhorn" aria-hidden="true"></i>
                    <i class="fa fa-long-arrow-alt-left" aria-hidden="true"></i>
                </div>
            </div>
            <!-- EDitor Start  -->
            <div class="icentra-editor creat-template-editor">
                <div class="ic-editor-inner">
                    <div class="ic-editor-header">
                        <!-- 1 -->
                        <div class="header-active-tool">
                   <span class="header-active-tool-sign">
                     <img src="assets/img/editor/create-task.png" alt="">
                   </span>
                            <div class="header-active-tool-name">
                                <h6>Task</h6>
                                <span>Marketing Set</span>
                            </div>
                        </div>
                    </div>
                    <div class="ic-editor-body">
                        <div class="ic-editor-sidebar no-tab-content">
                            <div class="ic-editor-sidebar-tools">
                                <!-- Tabs -->
                                <ul class="nav --nav-tabs ic-tools-tab" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link" routerLink="/setting/tasks/job-type">
                                            <img src="assets/img/editor/job-type.png" alt="">
                                            <img src="assets/img/editor/hvr-job-type.png" alt="" class="hvr">
                                            <span>Job Type</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" routerLink="/setting/tasks/category"
                                           *ngxPermissionsOnly="['task.printing.manager']">
                                            <img src="assets/img/editor/task-catgory.png" alt="">
                                            <img src="assets/img/editor/hvr-task-catgory.png" alt="" class="hvr">
                                            <span>Printing Type</span>
                                        </a>
                                    </li>
                                    <li class="nav-item" *ngxPermissionsOnly="['task.status.create', 'task.status.edit', 'task.status.delete']">
                                        <a class="nav-link" routerLink="/setting/tasks/status">
                                            <img src="assets/img/editor/status.png" alt="">
                                            <img src="assets/img/editor/hvr-status.png" alt="" class="hvr">
                                            <span>Status</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" routerLink="/setting/tasks/priority">
                                            <img src="assets/img/editor/priority.png" alt="">
                                            <img src="assets/img/editor/hvr-priority.png" alt="" class="hvr">
                                            <span>Priority</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link active" routerLink="/setting/tasks/marketing">
                                            <img src="assets/img/editor/marketing.png" alt="">
                                            <img src="assets/img/editor/hvr-marketing.png" alt="" class="hvr">
                                            <span>Marketing</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link"  routerLink="/setting/tasks/printing"
                                           *ngxPermissionsOnly="['task.printing.manager']">
                                            <img src="assets/img/editor/printing.png" alt="">
                                            <img src="assets/img/editor/hvr-printing-pink.png" alt="" class="hvr">
                                            <span>Printing</span>
                                        </a>
                                    </li>
                                </ul>
                            </div><!--/.ic-editor-sidebar-tools-->
                        </div><!--/-sidebar-->
                        <!-- Main -->
                        <div class="user-workarea">
                            <div class="create-user-form create-marketing-form">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Task Set Name</label>
                                            <input type="text" class="form-control" [(ngModel)]="setName">
                                            <span class="dummy-text"
                                                  *ngIf="setName === ''">
                                                            <span class="form-error">Name is required<br></span>
                                                        </span>
                                        </div>
                                    </div>
                                </div>

                                <h2>Create Your First Task in the marketing tasks</h2>

                                <form [formGroup]="MarketForm" (ngSubmit)="onSubmit()">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label>Task 1 Name</label>
                                                <input type="text" class="form-control" formControlName="title"
                                                       placeholder="Enter your task name, e.g Week 1 - Open Home">
                                                <span class="dummy-text"
                                                      *ngIf="MarketForm.controls['title'].touched">
                                                            <span class="form-error"
                                                                  *ngIf="MarketForm.controls['title'].hasError('required')">Name is required<br></span>
                                                        </span>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="">Job Type</label>
                                                        <ng-select formControlName="job_type_id" [items]="jobTypes"
                                                                   bindLabel="name" bindValue="id"
                                                                   placeholder="Select Type"></ng-select>
                                                        <span class="dummy-text"
                                                              *ngIf="MarketForm.controls['job_type_id'].touched">
                                                            <span class="form-error"
                                                                  *ngIf="MarketForm.controls['job_type_id'].hasError('required')">Job Type is required<br></span>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="">Category</label>
                                                        <ng-select formControlName="task_category_id"
                                                                   [items]="categories"
                                                                   bindLabel="name" bindValue="id"
                                                                   placeholder="Select Category"></ng-select>
                                                        <span class="dummy-text"
                                                              *ngIf="MarketForm.controls['task_category_id'].touched">
                                                            <span class="form-error"
                                                                  *ngIf="MarketForm.controls['task_category_id'].hasError('required')">Category is required<br></span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="">Status</label>
                                                        <ng-select formControlName="task_status_id"
                                                                   [items]="taskStatuses"
                                                                   bindLabel="name" bindValue="id"
                                                                   placeholder="Select Status"
                                                                   ></ng-select>
                                                        <span class="dummy-text"
                                                              *ngIf="MarketForm.controls['task_status_id'].touched">
                                                            <span class="form-error"
                                                                  *ngIf="MarketForm.controls['task_status_id'].hasError('required')">Status is required<br></span>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="">Priority</label>
                                                        <ng-select formControlName="priority_id" [items]="priorities"
                                                                   bindLabel="name" bindValue="id"
                                                                   placeholder="Select Priority"></ng-select>
                                                        <span class="dummy-text"
                                                              *ngIf="MarketForm.controls['priority_id'].touched">
                                                            <span class="form-error"
                                                                  *ngIf="MarketForm.controls['priority_id'].hasError('required')">Priority is required<br></span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Duration (in Days)</label>
                                                        <div class="custom-site-quantity">
                                                            <span class="btn-dec" (click)="changeQtyBox('minus')">-</span>
                                                            <input type="number" class="form-control"
                                                                   formControlName="duration" min="1">
                                                            <span class="btn-inc" (click)="changeQtyBox('plus')">+</span>
                                                        </div>
                                                        <span class="dummy-text"
                                                              *ngIf="MarketForm.controls['duration'].touched">
                                                            <span class="form-error"
                                                                  *ngIf="MarketForm.controls['duration'].hasError('required')">Duration is required<br></span>
                                                        </span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="website-features mt-3 mb-4">
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="task-switch-wrap">
                                                    <p>Property</p>
                                                    <label class="switch">
                                                        <input type="checkbox" formControlName="is_property">
                                                        <span class="slider"></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="task-switch-wrap">
                                                    <p>Assignee</p>
                                                    <label class="switch">
                                                        <input type="checkbox" formControlName="is_assign">
                                                        <span class="slider"></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="task-switch-wrap">
                                                    <p>Comments</p>
                                                    <label class="switch">
                                                        <input type="checkbox" formControlName="is_commenting">
                                                        <span class="slider"></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="task-switch-wrap">
                                                    <p>Printing</p>
                                                    <label class="switch">
                                                        <input type="checkbox" formControlName="is_printing">
                                                        <span class="slider"></span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div><!--/.row-->
                                    </div>


                                    <div class="row">
                                        <div class="col-md-12 text-right">
                                            <div class="form-group">
                                                <button class="btn btn-primary" *ngIf="editMode === -1" type="submit">Add to List</button>
                                                <button class="btn btn-primary" *ngIf="editMode !== -1" type="submit">Update</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>


                                <h2 class="mt-1">task in marketing set</h2>
                                <div class="row">
                                    <div class=" col-md-12 job-table-body task-table-body" *ngIf="subTaskList">
                                        <!-- Table Start -->
                                        <div class="table-responsive">
                                            <table class="table table-bordered" style="border:1px solid #e6e7eb;border-top:none;">
                                                <thead>
                                                <tr>
                                                    <th scope="col">Title</th>
                                                    <th scope="col">Job Type</th>
                                                    <th scope="col">Category</th>
                                                    <th scope="col">Status</th>
                                                    <th scope="col">Priority</th>
                                                    <th scope="col">Duration</th>
                                                    <th scope="col">Property</th>
                                                    <th scope="col">Commenting</th>
                                                    <th scope="col">Assigned</th>
                                                    <th scope="col">Printing</th>
                                                    <th scope="col">Actions</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr *ngFor="let sub Of subTaskList">
                                                    <td>{{ sub.title }}</td>
                                                    <td>{{ getNameById(sub.job_type_id, 'type') }}</td>
                                                    <td>{{ getNameById(sub.task_category_id, 'category') }}</td>
                                                    <td>{{ getNameById(sub.task_status_id, 'status') }}</td>
                                                    <td>{{ getNameById(sub.priority_id, 'priority') }}</td>
                                                    <td>{{ sub.duration }}</td>
                                                    <td>
                                                        <img *ngIf="sub.is_property"
                                                             src="assets/img/editor/color-tick.png"/>
                                                        <img *ngIf="!sub.is_property"
                                                             src="assets/img/editor/color-cancel.png"/>
                                                    </td>
                                                    <td>
                                                        <img *ngIf="sub.is_commenting"
                                                             src="assets/img/editor/color-tick.png"/>
                                                        <img *ngIf="!sub.is_commenting"
                                                             src="assets/img/editor/color-cancel.png"/>
                                                    </td>
                                                    <td>
                                                        <img *ngIf="sub.is_assign"
                                                             src="assets/img/editor/color-tick.png"/>
                                                        <img *ngIf="!sub.is_assign"
                                                             src="assets/img/editor/color-cancel.png"/>
                                                    </td>
                                                    <td>
                                                        <img *ngIf="sub.is_printing"
                                                             src="assets/img/editor/color-tick.png"/>
                                                        <img *ngIf="!sub.is_printing"
                                                             src="assets/img/editor/color-cancel.png"/>
                                                    </td>
                                                    <td>
                                                        <a class="cursor-pointer" (click)="deleteThisSubTask(sub)">
                                                            <img src="assets/img/editor/yellow-delete.png"/>
                                                        </a>
                                                        <a class="cursor-pointer" (click)="enableEditMode(sub)">
                                                            <img src="assets/img/editor/yellow-edit.png"/>
                                                        </a>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table><br/><br/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 text-right">
                                        <div class="form-group">
                                            <button class="btn btn-primary"
                                                    [disabled]="subTaskList.length === 0 || setName === ''" (click)="submitToDB()">Save Task
                                                Set
                                            </button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div><!--/end-main-->
                    </div><!--/body-->
                </div>
            </div>
            <!-- EDitor End -->
        </div>
        <!--/.container-fluid-->
    </div>
    <!--/.content-wrapper-->
    <!-- Activity Stream -->
    <app-activity-stream></app-activity-stream>
</div><!-- /.inner-wrapper -->
